window.__require=function t(e,o,i){function n(r,c){if(!o[r]){if(!e[r]){var l=r.split("/");if(l=l[l.length-1],!e[l]){var a="function"==typeof __require&&__require;if(!c&&a)return a(l,!0);if(s)return s(l,!0);throw new Error("Cannot find module '"+r+"'")}r=l}var p=o[r]={exports:{}};e[r][0].call(p.exports,function(t){return n(e[r][1][t]||t)},p,p.exports,t,e,o,i)}return o[r].exports}for(var s="function"==typeof __require&&__require,r=0;r<i.length;r++)n(i[r]);return n}({AnimationManager:[function(t,e,o){"use strict";cc._RF.push(e,"6823eP4t2hAPrFE+1ju+Gol","AnimationManager");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=this&&this.__decorate||function(t,e,o,i){var n,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(s<3?n(r):s>3?n(e,o,r):n(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.AnimationManager=void 0;var r=cc._decorator,c=r.ccclass,l=(r.property,t("../Core/EventSystem")),a=t("../Utils/WorldPositionUtils"),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){this.eventSystem=l.EventSystem.getInstance(),this.setupEventListeners()},e.prototype.setupEventListeners=function(){this.eventSystem.on(l.Events.TILES_BURNED,this.onTilesBurned.bind(this)),this.eventSystem.on(l.Events.TILES_FELL,this.onTilesFell.bind(this)),this.eventSystem.on(l.Events.ANIMATION_COMPLETED,this.onAnimationCompleted.bind(this))},e.prototype.onTilesBurned=function(t){t&&this.animateTileDestruction(t)},e.prototype.onTilesFell=function(t){t&&this.animateTileFall(t)},e.prototype.onAnimationCompleted=function(t){t&&"destruction"===t.type&&t.positions&&this.eventSystem.emit(l.Events.TILES_DESTROYED,t.positions)},e.prototype.animateTileDestruction=function(t){for(var e=this,o=0,i=t.length,n=function(n){var r=s.getTileNodeAt(n);if(r){var c=cc.tween(r).to(.3,{opacity:0,scale:0}).call(function(){++o>=i&&e.eventSystem.emit(l.Events.ANIMATION_COMPLETED,{type:"destruction",positions:t})}).start(),a=function(){c&&c.stop()};r.on("destroy",a),r.on("remove",a)}else++o>=i&&s.eventSystem.emit(l.Events.ANIMATION_COMPLETED,{type:"destruction",positions:t})},s=this,r=0,c=t;r<c.length;r++)n(c[r])},e.prototype.animateTileFall=function(t){for(var e=function(t){var e=o.getTileNodeAt(t);if(e){var i=o.getWorldPosition(t),n=cc.tween(e).to(.15,{position:cc.v3(i.x,i.y,0)}).start(),s=function(){n&&n.stop()};e.on("destroy",s),e.on("remove",s)}},o=this,i=0,n=t;i<n.length;i++)e(n[i])},e.prototype.animateNewTilesCreation=function(t){for(var e=function(e){var i=t[e],n=o.getTileNodeAt(i);if(n){var s=o.getWorldPosition(i),r=s.y+200;n.y=r;var c=cc.tween(n).to(.2,{position:cc.v3(s.x,s.y,0)}).start(),l=function(){c&&c.stop()};n.on("destroy",l),n.on("remove",l)}},o=this,i=0;i<t.length;i++)e(i)},e.prototype.getTileNodeAt=function(t){var e=cc.find("Canvas/HUD/GameField/TileContainer");if(e&&e.children)for(var o=0,i=e.children;o<i.length;o++){var n=i[o],s=n.getComponent("Tile");if(s&&s.position&&s.position.x===t.x&&s.position.y===t.y)return n}return null},e.prototype.getWorldPosition=function(t){return a.WorldPositionUtils.getWorldPosition(t)},e.prototype.onDestroy=function(){this.eventSystem.off(l.Events.TILES_BURNED,this.onTilesBurned.bind(this)),this.eventSystem.off(l.Events.TILES_FELL,this.onTilesFell.bind(this))},s([c],e)}(cc.Component);o.AnimationManager=p,cc._RF.pop()},{"../Core/EventSystem":"EventSystem","../Utils/WorldPositionUtils":"WorldPositionUtils"}],BoosterSystem:[function(t,e,o){"use strict";cc._RF.push(e,"2c297BnPN5O35GF0eJ2wDXB","BoosterSystem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=this&&this.__decorate||function(t,e,o,i){var n,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(s<3?n(r):s>3?n(e,o,r):n(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterSystem=void 0;var r=cc._decorator,c=r.ccclass,l=(r.property,t("../Core/BoosterTypes")),a=t("../Core/EventSystem"),p=t("../Utils/TileAreaUtils"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boosterState={bomb:3,teleport:5},e.activation={type:l.BoosterType.BOMB,isActive:!1,selectedTiles:[]},e}return n(e,t),e.prototype.onLoad=function(){this.eventSystem=a.EventSystem.getInstance(),this.setupEventListeners()},e.prototype.setupEventListeners=function(){this.eventSystem.on(a.Events.TILE_CLICKED,this.handleTileClick.bind(this))},e.prototype.activateBooster=function(t){this.canActivateBooster(t)&&(this.activation.isActive&&this.deactivateBooster(),this.activation={type:t,isActive:!0,selectedTiles:[]},this.eventSystem.emit(a.Events.BOOSTER_ACTIVATED,{type:t,instruction:this.getBoosterInstruction(t)}))},e.prototype.canActivateBooster=function(t){switch(t){case l.BoosterType.BOMB:return this.boosterState.bomb>0;case l.BoosterType.TELEPORT:return this.boosterState.teleport>0;default:return!1}},e.prototype.handleTileClick=function(t){if(t){var e=t;if(this.activation.isActive)switch(this.activation.type){case l.BoosterType.BOMB:this.handleBombClick(e);break;case l.BoosterType.TELEPORT:this.handleTeleportClick(e)}}},e.prototype.handleBombClick=function(t){var e=this.getTilesInRadius(t,1);e.length>0&&(this.eventSystem.emit(a.Events.BOOSTER_BOMB_EXECUTE,{positions:e,center:t}),this.consumeBooster(l.BoosterType.BOMB),this.deactivateBooster(),this.eventSystem.emit(a.Events.GROUP_BURNED_SUCCESSFULLY))},e.prototype.handleTeleportClick=function(t){if(this.activation.selectedTiles.push(t),1===this.activation.selectedTiles.length)this.eventSystem.emit(a.Events.TELEPORT_FIRST_TILE_SELECTED,{position:t});else if(2===this.activation.selectedTiles.length){var e=this.activation.selectedTiles,o=e[0],i=e[1];this.eventSystem.emit(a.Events.BOOSTER_TELEPORT_EXECUTE,{position1:o,position2:i}),this.consumeBooster(l.BoosterType.TELEPORT),this.deactivateBooster(),this.eventSystem.emit(a.Events.GROUP_BURNED_SUCCESSFULLY)}},e.prototype.getTilesInRadius=function(t,e){return p.TileAreaUtils.getTilesInRadius(t,e)},e.prototype.consumeBooster=function(t){switch(t){case l.BoosterType.BOMB:this.boosterState.bomb>0&&this.boosterState.bomb--;break;case l.BoosterType.TELEPORT:this.boosterState.teleport>0&&this.boosterState.teleport--}this.eventSystem.emit(a.Events.BOOSTER_UI_UPDATE,this.boosterState)},e.prototype.deactivateBooster=function(){this.activation.isActive&&(this.activation={type:l.BoosterType.BOMB,isActive:!1,selectedTiles:[]},this.eventSystem.emit(a.Events.BOOSTER_DEACTIVATED,{type:this.activation.type}))},e.prototype.getBoosterInstruction=function(t){switch(t){case l.BoosterType.BOMB:return"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u0430\u0439\u043b \u0434\u043b\u044f \u0432\u0437\u0440\u044b\u0432\u0430 (3x3 \u043e\u0431\u043b\u0430\u0441\u0442\u044c)";case l.BoosterType.TELEPORT:return"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0432\u0430 \u0442\u0430\u0439\u043b\u0430 \u0434\u043b\u044f \u043e\u0431\u043c\u0435\u043d\u0430 \u043c\u0435\u0441\u0442\u0430\u043c\u0438";default:return"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439 \u0431\u0443\u0441\u0442\u0435\u0440"}},e.prototype.getBoosterCount=function(t){switch(t){case l.BoosterType.BOMB:return this.boosterState.bomb;case l.BoosterType.TELEPORT:return this.boosterState.teleport;default:return 0}},e.prototype.isBoosterActive=function(){return this.activation.isActive},e.prototype.getActiveBoosterType=function(){return this.activation.isActive?this.activation.type:null},e.prototype.resetBoosters=function(){this.boosterState={bomb:3,teleport:5},this.activation.isActive&&this.deactivateBooster(),this.eventSystem.emit(a.Events.BOOSTER_UI_UPDATE,this.boosterState)},e.prototype.onDestroy=function(){this.eventSystem.off(a.Events.TILE_CLICKED,this.handleTileClick.bind(this))},s([c],e)}(cc.Component);o.BoosterSystem=u,cc._RF.pop()},{"../Core/BoosterTypes":"BoosterTypes","../Core/EventSystem":"EventSystem","../Utils/TileAreaUtils":"TileAreaUtils"}],BoosterTypes:[function(t,e,o){"use strict";cc._RF.push(e,"aefe6GWYNRJir/Accljdk+k","BoosterTypes"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterState=o.BoosterType=void 0,function(t){t.BOMB="bomb",t.TELEPORT="teleport"}(o.BoosterType||(o.BoosterType={})),function(t){t.INACTIVE="inactive",t.ACTIVE="active",t.WAITING_TARGET="waiting_target"}(o.BoosterState||(o.BoosterState={})),cc._RF.pop()},{}],BoosterUI:[function(t,e,o){"use strict";cc._RF.push(e,"0323b7kexVKc4O7JkuDQaWA","BoosterUI");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=this&&this.__decorate||function(t,e,o,i){var n,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(s<3?n(r):s>3?n(e,o,r):n(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterUI=void 0;var r=cc._decorator,c=r.ccclass,l=r.property,a=t("../Core/BoosterTypes"),p=t("../Core/EventSystem"),u=t("./BoosterSystem"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bombCountLabel=null,e.teleportCountLabel=null,e.bombButton=null,e.teleportButton=null,e.boosterSystem=null,e}return n(e,t),e.prototype.onLoad=function(){this.eventSystem=p.EventSystem.getInstance(),this.setupEventListeners(),this.setupButtons(),this.updateUI()},e.prototype.setupEventListeners=function(){this.eventSystem.on(p.Events.BOOSTER_UI_UPDATE,this.onUIUpdate.bind(this)),this.eventSystem.on(p.Events.BOOSTER_ACTIVATED,this.onBoosterActivated.bind(this)),this.eventSystem.on(p.Events.BOOSTER_DEACTIVATED,this.onBoosterDeactivated.bind(this))},e.prototype.setupButtons=function(){this.bombButton&&this.bombButton.node.on(cc.Node.EventType.TOUCH_END,this.onBombButtonClicked.bind(this)),this.teleportButton&&this.teleportButton.node.on(cc.Node.EventType.TOUCH_END,this.onTeleportButtonClicked.bind(this))},e.prototype.onBombButtonClicked=function(){this.boosterSystem&&this.boosterSystem.activateBooster(a.BoosterType.BOMB)},e.prototype.onTeleportButtonClicked=function(){this.boosterSystem&&this.boosterSystem.activateBooster(a.BoosterType.TELEPORT)},e.prototype.onUIUpdate=function(){this.updateUI()},e.prototype.onBoosterActivated=function(t){this.updateUI(),this.showBoosterActivationEffect(null==t?void 0:t.type)},e.prototype.onBoosterDeactivated=function(){this.updateUI(),this.hideBoosterActivationEffect()},e.prototype.updateUI=function(){if(this.boosterSystem){if(this.bombCountLabel){var t=this.boosterSystem.getBoosterCount(a.BoosterType.BOMB);this.bombCountLabel.string=t.toString()}if(this.teleportCountLabel){var e=this.boosterSystem.getBoosterCount(a.BoosterType.TELEPORT);this.teleportCountLabel.string=e.toString()}this.updateButtonStates()}},e.prototype.updateButtonStates=function(){this.updateBombButtonState(),this.updateTeleportButtonState()},e.prototype.updateBombButtonState=function(){if(this.bombButton&&this.boosterSystem){var t=this.boosterSystem.getBoosterCount(a.BoosterType.BOMB)>0;this.bombButton.interactable=t,this.updateButtonVisual(this.bombButton,t)}},e.prototype.updateTeleportButtonState=function(){if(this.teleportButton&&this.boosterSystem){var t=this.boosterSystem.getBoosterCount(a.BoosterType.TELEPORT)>0;this.teleportButton.interactable=t,this.updateButtonVisual(this.teleportButton,t)}},e.prototype.updateButtonVisual=function(t,e){if(t&&t.node){var o=e?255:128;t.node.opacity=o}},e.prototype.showBoosterActivationEffect=function(t){if(t){var e=null;t===a.BoosterType.BOMB&&this.bombButton?e=this.bombButton:t===a.BoosterType.TELEPORT&&this.teleportButton&&(e=this.teleportButton),e&&e.node&&cc.tween(e.node).repeatForever(cc.tween().to(.5,{scale:1.1}).to(.5,{scale:1})).start()}},e.prototype.hideBoosterActivationEffect=function(){this.bombButton&&this.bombButton.node&&(cc.Tween.stopAllByTarget(this.bombButton.node),this.bombButton.node.scale=1),this.teleportButton&&this.teleportButton.node&&(cc.Tween.stopAllByTarget(this.teleportButton.node),this.teleportButton.node.scale=1)},e.prototype.onDestroy=function(){this.eventSystem.off(p.Events.BOOSTER_UI_UPDATE,this.onUIUpdate.bind(this)),this.eventSystem.off(p.Events.BOOSTER_ACTIVATED,this.onBoosterActivated.bind(this)),this.eventSystem.off(p.Events.BOOSTER_DEACTIVATED,this.onBoosterDeactivated.bind(this))},s([l(cc.Label)],e.prototype,"bombCountLabel",void 0),s([l(cc.Label)],e.prototype,"teleportCountLabel",void 0),s([l(cc.Button)],e.prototype,"bombButton",void 0),s([l(cc.Button)],e.prototype,"teleportButton",void 0),s([l(u.BoosterSystem)],e.prototype,"boosterSystem",void 0),s([c],e)}(cc.Component);o.BoosterUI=h,cc._RF.pop()},{"../Core/BoosterTypes":"BoosterTypes","../Core/EventSystem":"EventSystem","./BoosterSystem":"BoosterSystem"}],EventSystem:[function(t,e,o){"use strict";cc._RF.push(e,"ffa117Ab1tHUJLkMVWpTwwf","EventSystem"),Object.defineProperty(o,"__esModule",{value:!0}),o.Events=o.EventSystem=void 0;var i=function(){function t(){this.events=new Map}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.clear=function(){this.events.clear()},t.prototype.on=function(t,e){this.events.has(t)||this.events.set(t,[]),this.events.get(t).push(e)},t.prototype.off=function(t,e){var o=this.events.get(t);if(o){var i=o.indexOf(e);i>-1&&o.splice(i,1)}},t.prototype.emit=function(t,e){var o=this.events.get(t);o&&o.forEach(function(t){return t(e)})},t}();o.EventSystem=i,o.Events={GAME_STATE_CHANGED:"game_state_changed",TILE_CLICKED:"tile_clicked",TILES_BURNED:"tiles_burned",TILES_FELL:"tiles_fell",SCORE_CHANGED:"score_changed",MOVES_CHANGED:"moves_changed",GAME_WON:"game_won",GAME_LOST:"game_lost",BOOSTER_ACTIVATED:"booster_activated",BOOSTER_DEACTIVATED:"booster_deactivated",BOOSTER_USED:"booster_used",BOOSTER_BUTTON_CLICKED:"booster_button_clicked",BOOSTER_TARGET_SELECTED:"booster_target_selected",BOOSTER_UI_UPDATE:"booster_ui_update",BOOSTER_BOMB_EXECUTE:"booster_bomb_execute",BOOSTER_TELEPORT_EXECUTE:"booster_teleport_execute",TELEPORT_FIRST_TILE_SELECTED:"teleport_first_tile_selected",TILES_SWAPPED:"tiles_swapped",ANIMATION_COMPLETED:"animation_completed",UI_UPDATE_REQUESTED:"ui_update_requested",TILES_DESTROYED:"tiles_destroyed",GROUP_BURNED_SUCCESSFULLY:"group_burned_successfully"},cc._RF.pop()},{}],GameField:[function(t,e,o){"use strict";cc._RF.push(e,"89a92ATPb9C9LX3wzhOjMTe","GameField");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=this&&this.__decorate||function(t,e,o,i){var n,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(s<3?n(r):s>3?n(e,o,r):n(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.GameField=void 0;var r=cc._decorator,c=r.ccclass,l=r.property,a=t("../Core/EventSystem"),p=t("../Utils/PositionUtils"),u=t("../Utils/WorldPositionUtils"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tileContainer=null,e.tilePrefab=null,e}return n(e,t),e.prototype.onLoad=function(){this.eventSystem=a.EventSystem.getInstance()},e.prototype.initializeField=function(t){this.config=t,this.createField()},e.prototype.createField=function(){this.field=[];for(var t=0;t<this.config.fieldWidth;t++){this.field[t]=[];for(var e=0;e<this.config.fieldHeight;e++)this.field[t][e]=null}},e.prototype.getTileAt=function(t){return this.isValidPosition(t)?this.field[t.x][t.y]:null},e.prototype.setTileAt=function(t,e){this.isValidPosition(t)&&(this.field[t.x][t.y]=e)},e.prototype.removeTileAt=function(t){this.isValidPosition(t)&&(this.field[t.x][t.y]=null)},e.prototype.isValidPosition=function(t){return p.PositionUtils.isValidPosition(t)},e.prototype.getWorldPosition=function(t){return u.WorldPositionUtils.getWorldPositionForField(t)},e.prototype.getAllPositions=function(){for(var t=[],e=0;e<this.config.fieldWidth;e++)for(var o=0;o<this.config.fieldHeight;o++)t.push({x:e,y:o});return t},s([l(cc.Node)],e.prototype,"tileContainer",void 0),s([l(cc.Prefab)],e.prototype,"tilePrefab",void 0),s([c],e)}(cc.Component);o.GameField=h,cc._RF.pop()},{"../Core/EventSystem":"EventSystem","../Utils/PositionUtils":"PositionUtils","../Utils/WorldPositionUtils":"WorldPositionUtils"}],GameManager:[function(t,e,o){"use strict";cc._RF.push(e,"977daMXQPNE0bBXNhd9enpp","GameManager");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var e,o=1,i=arguments.length;o<i;o++)for(var n in e=arguments[o])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},r=this&&this.__decorate||function(t,e,o,i){var n,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(s<3?n(r):s>3?n(e,o,r):n(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.GameManager=void 0;var c=cc._decorator,l=c.ccclass,a=c.property,p=t("./GameState"),u=t("./EventSystem"),h=t("../Field/TileContainer"),y=t("../Boosters/BoosterSystem"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameField=null,e.tileContainer=null,e.tileContainerComponent=null,e.boosterSystem=null,e.currentState=p.GameState.MENU,e}return n(e,t),e.prototype.onLoad=function(){this.eventSystem=u.EventSystem.getInstance(),this.setupConfig(),this.setupStats(),this.setupEventListeners()},e.prototype.start=function(){this.startNewGame()},e.prototype.setupConfig=function(){this.config={fieldWidth:8,fieldHeight:8,targetScore:1500,maxMoves:25,shuffleAttempts:2}},e.prototype.setupStats=function(){this.stats={score:0,moves:Math.max(0,this.config.maxMoves),targetScore:this.config.targetScore,maxMoves:this.config.maxMoves,shufflesLeft:this.config.shuffleAttempts,isGameOver:!1,isWin:!1}},e.prototype.setupEventListeners=function(){this.boundOnTileClicked=this.onTileClicked.bind(this),this.boundOnTilesBurned=this.onTilesBurned.bind(this),this.boundOnGroupBurnedSuccessfully=this.onGroupBurnedSuccessfully.bind(this),this.eventSystem.on(u.Events.TILE_CLICKED,this.boundOnTileClicked),this.eventSystem.on(u.Events.TILES_BURNED,this.boundOnTilesBurned),this.eventSystem.on(u.Events.GROUP_BURNED_SUCCESSFULLY,this.boundOnGroupBurnedSuccessfully)},e.prototype.startNewGame=function(){this.setGameState(p.GameState.PLAYING),this.eventSystem.emit(u.Events.UI_UPDATE_REQUESTED,this.stats),this.tileContainerComponent&&this.config&&this.tileContainerComponent.initializeContainer(this.config)},e.prototype.setGameState=function(t){this.currentState!==t&&(this.currentState=t,this.eventSystem.emit(u.Events.GAME_STATE_CHANGED,t))},e.prototype.onTileClicked=function(t){t&&this.currentState===p.GameState.PLAYING&&this.stats.moves},e.prototype.onTilesBurned=function(t){if(t){var e=10*t.length;this.stats.score+=e,this.eventSystem.emit(u.Events.SCORE_CHANGED,this.stats.score),this.checkGameEnd()}},e.prototype.onGroupBurnedSuccessfully=function(){this.stats.moves=Math.max(0,this.stats.moves-1),this.eventSystem.emit(u.Events.MOVES_CHANGED,this.stats.moves)},e.prototype.checkGameEnd=function(){this.stats.score>=this.stats.targetScore&&!this.stats.isGameOver?this.endGame(!0,"\u0426\u0435\u043b\u0435\u0432\u043e\u0439 \u0441\u0447\u0435\u0442 \u0434\u043e\u0441\u0442\u0438\u0433\u043d\u0443\u0442!"):this.stats.moves<=0&&!this.stats.isGameOver&&this.handleNoMovesLeft()},e.prototype.handleNoMovesLeft=function(){var t=this;this.stats.shufflesLeft>0?(this.stats.shufflesLeft--,this.stats.moves+=5,this.eventSystem.emit(u.Events.MOVES_CHANGED,this.stats.moves),this.scheduleOnce(function(){t.shuffleField()},.5)):this.endGame(!1,"\u0417\u0430\u043a\u043e\u043d\u0447\u0438\u043b\u0438\u0441\u044c \u0445\u043e\u0434\u044b \u0438 \u043f\u043e\u043f\u044b\u0442\u043a\u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u0448\u0438\u0432\u0430\u043d\u0438\u044f")},e.prototype.shuffleField=function(){this.tileContainerComponent&&this.tileContainerComponent.shuffleField()},e.prototype.endGame=function(t){var e=this;this.stats.isGameOver=!0,this.stats.isWin=t,t?this.eventSystem.emit(u.Events.GAME_WON):this.eventSystem.emit(u.Events.GAME_LOST),this.scheduleOnce(function(){e.restartGame()},3)},e.prototype.restartGame=function(){this.setupStats(),this.boosterSystem&&this.boosterSystem.resetBoosters(),this.tileContainerComponent&&this.tileContainerComponent.initializeContainer(this.config),this.eventSystem.emit(u.Events.UI_UPDATE_REQUESTED,this.stats)},e.prototype.onDestroy=function(){this.eventSystem.off(u.Events.TILE_CLICKED,this.boundOnTileClicked),this.eventSystem.off(u.Events.TILES_BURNED,this.boundOnTilesBurned),this.eventSystem.off(u.Events.GROUP_BURNED_SUCCESSFULLY,this.boundOnGroupBurnedSuccessfully)},e.prototype.refreshEntireField=function(){this.tileContainerComponent&&this.tileContainerComponent.refreshEntireField()},e.prototype.getCurrentState=function(){return this.currentState},e.prototype.getStats=function(){return s({},this.stats)},e.prototype.getConfig=function(){return s({},this.config)},r([a(cc.Node)],e.prototype,"gameField",void 0),r([a(cc.Node)],e.prototype,"tileContainer",void 0),r([a(h.TileContainer)],e.prototype,"tileContainerComponent",void 0),r([a(y.BoosterSystem)],e.prototype,"boosterSystem",void 0),r([l],e)}(cc.Component);o.GameManager=f,cc._RF.pop()},{"../Boosters/BoosterSystem":"BoosterSystem","../Field/TileContainer":"TileContainer","./EventSystem":"EventSystem","./GameState":"GameState"}],GameState:[function(t,e,o){"use strict";cc._RF.push(e,"da8caMzee5CPZmaSGWQlXcX","GameState"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileState=o.TileType=o.GameState=void 0,function(t){t.MENU="menu",t.PLAYING="playing",t.PAUSED="paused",t.GAME_OVER="game_over",t.VICTORY="victory"}(o.GameState||(o.GameState={})),function(t){t.BLUE="blue",t.GREEN="green",t.RED="red",t.YELLOW="yellow",t.PURPLE="purple",t.SUPER_ROW="super_row",t.SUPER_COLUMN="super_column",t.SUPER_BOMB="super_bomb",t.SUPER_BOMB_MAX="super_bomb_max"}(o.TileType||(o.TileType={})),function(t){t.NORMAL="normal",t.BURNING="burning",t.FALLING="falling",t.SPAWNING="spawning"}(o.TileState||(o.TileState={})),cc._RF.pop()},{}],GameUIManager:[function(t,e,o){"use strict";cc._RF.push(e,"1809aE+o2VPi4uCHrnyP0F2","GameUIManager");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=this&&this.__decorate||function(t,e,o,i){var n,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(s<3?n(r):s>3?n(e,o,r):n(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.GameUIManager=void 0;var r=cc._decorator,c=r.ccclass,l=r.property,a=t("../Core/EventSystem"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scoreLabel=null,e.movesLabel=null,e.winLoseLabel=null,e}return n(e,t),e.prototype.onLoad=function(){this.eventSystem=a.EventSystem.getInstance(),this.setupEventListeners(),this.hideWinLoseMessage()},e.prototype.setupEventListeners=function(){this.eventSystem.on(a.Events.SCORE_CHANGED,this.onScoreChanged.bind(this)),this.eventSystem.on(a.Events.MOVES_CHANGED,this.onMovesChanged.bind(this)),this.eventSystem.on(a.Events.GAME_WON,this.onGameWon.bind(this)),this.eventSystem.on(a.Events.GAME_LOST,this.onGameLost.bind(this)),this.eventSystem.on(a.Events.UI_UPDATE_REQUESTED,this.onUIUpdateRequested.bind(this))},e.prototype.onScoreChanged=function(t){void 0!==t&&this.updateScoreDisplay(t)},e.prototype.onMovesChanged=function(t){void 0!==t&&this.updateMovesDisplay(t)},e.prototype.onGameWon=function(){this.showWinMessage()},e.prototype.onGameLost=function(){this.showLoseMessage()},e.prototype.onUIUpdateRequested=function(t){t&&(this.updateScoreDisplay(t.score),this.updateMovesDisplay(t.moves),this.hideWinLoseMessage())},e.prototype.updateScoreDisplay=function(t){this.scoreLabel&&(this.scoreLabel.string="\u041e\u0427\u041a\u0418:\n"+t+"/1500")},e.prototype.updateMovesDisplay=function(t){this.movesLabel&&(this.movesLabel.string=t.toString())},e.prototype.showWinMessage=function(){this.winLoseLabel&&(this.winLoseLabel.string="\u041f\u041e\u0411\u0415\u0414\u0410!",this.winLoseLabel.node.color=cc.Color.GREEN,this.animateWinLoseMessage())},e.prototype.showLoseMessage=function(){this.winLoseLabel&&(this.winLoseLabel.string="\u041f\u041e\u0420\u0410\u0416\u0415\u041d\u0418\u0415",this.winLoseLabel.node.color=cc.Color.RED,this.animateWinLoseMessage())},e.prototype.animateWinLoseMessage=function(){if(this.winLoseLabel){this.winLoseLabel.node.active=!0,this.winLoseLabel.node.scale=0;var t=cc.tween(this.winLoseLabel.node).to(.5,{scale:1}).start(),e=function(){t&&t.stop()};this.winLoseLabel.node.on("destroy",e),this.winLoseLabel.node.on("remove",e)}},e.prototype.hideWinLoseMessage=function(){this.winLoseLabel&&(this.winLoseLabel.node.active=!1)},e.prototype.onDestroy=function(){this.eventSystem.off(a.Events.SCORE_CHANGED,this.onScoreChanged.bind(this)),this.eventSystem.off(a.Events.MOVES_CHANGED,this.onMovesChanged.bind(this)),this.eventSystem.off(a.Events.GAME_WON,this.onGameWon.bind(this)),this.eventSystem.off(a.Events.GAME_LOST,this.onGameLost.bind(this)),this.eventSystem.off(a.Events.UI_UPDATE_REQUESTED,this.onUIUpdateRequested.bind(this))},s([l(cc.Label)],e.prototype,"scoreLabel",void 0),s([l(cc.Label)],e.prototype,"movesLabel",void 0),s([l(cc.Label)],e.prototype,"winLoseLabel",void 0),s([c],e)}(cc.Component);o.GameUIManager=p,cc._RF.pop()},{"../Core/EventSystem":"EventSystem"}],PositionUtils:[function(t,e,o){"use strict";cc._RF.push(e,"9d475knq2VFBpy0pMxTXHP7","PositionUtils"),Object.defineProperty(o,"__esModule",{value:!0}),o.PositionUtils=void 0;var i=function(){function t(){}return t.isValidPosition=function(t){return t.x>=0&&t.x<this.FIELD_WIDTH&&t.y>=0&&t.y<this.FIELD_HEIGHT},t.isValidPositionXY=function(t,e){return t>=0&&t<this.FIELD_WIDTH&&e>=0&&e<this.FIELD_HEIGHT},t.arePositionsEqual=function(t,e){return t.x===e.x&&t.y===e.y},t.getDistance=function(t,e){var o=t.x-e.x,i=t.y-e.y;return Math.sqrt(o*o+i*i)},t.FIELD_WIDTH=8,t.FIELD_HEIGHT=8,t}();o.PositionUtils=i,cc._RF.pop()},{}],TileAreaUtils:[function(t,e,o){"use strict";cc._RF.push(e,"837b19muPZIQLkpcMPWSk5B","TileAreaUtils");var i=this&&this.__spreadArrays||function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<o;e++)for(var s=arguments[e],r=0,c=s.length;r<c;r++,n++)i[n]=s[r];return i};Object.defineProperty(o,"__esModule",{value:!0}),o.TileAreaUtils=void 0;var n=t("./PositionUtils"),s=function(){function t(){}return t.getTilesInRadius=function(t,e){for(var o=[],i=t.y-e;i<=t.y+e;i++)for(var s=t.x-e;s<=t.x+e;s++)n.PositionUtils.isValidPositionXY(s,i)&&o.push({x:s,y:i});return o},t.getTilesInRow=function(t){for(var e=[],o=0;o<8;o++)e.push({x:o,y:t});return e},t.getTilesInColumn=function(t){for(var e=[],o=0;o<8;o++)e.push({x:t,y:o});return e},t.mergeTilePositions=function(t,e){for(var o=i(t),n=new Set(t.map(function(t){return t.x+","+t.y})),s=0,r=e;s<r.length;s++){var c=r[s],l=c.x+","+c.y;n.has(l)||(o.push(c),n.add(l))}return o},t.containsPosition=function(t,e){return t.some(function(t){return n.PositionUtils.arePositionsEqual(t,e)})},t}();o.TileAreaUtils=s,cc._RF.pop()},{"./PositionUtils":"PositionUtils"}],TileContainer:[function(t,e,o){"use strict";cc._RF.push(e,"73e37YpANpFD7O2Jamya+Tj","TileContainer");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=this&&this.__decorate||function(t,e,o,i){var n,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(s<3?n(r):s>3?n(e,o,r):n(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.TileContainer=void 0;var r=cc._decorator,c=r.ccclass,l=r.property,a=t("../Core/GameState"),p=t("../Tiles/TileFactory"),u=t("../Tiles/Tile"),h=t("../Core/EventSystem"),y=t("../Boosters/BoosterSystem"),f=t("../Utils/PositionUtils"),d=t("../Utils/TileAreaUtils"),v=t("../Utils/WorldPositionUtils"),T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tilePrefab=null,e.boosterSystem=null,e.tiles=[],e.wasSuperTileActivation=!1,e}return n(e,t),e.prototype.onLoad=function(){this.eventSystem=h.EventSystem.getInstance(),this.setupEventListeners()},e.prototype.setupEventListeners=function(){this.boundOnTileClicked=this.onTileClicked.bind(this),this.boundOnBombExecute=this.onBombExecute.bind(this),this.boundOnTeleportExecute=this.onTeleportExecute.bind(this),this.boundOnTilesDestroyed=this.onTilesDestroyed.bind(this),this.eventSystem.on(h.Events.TILE_CLICKED,this.boundOnTileClicked),this.eventSystem.on(h.Events.BOOSTER_BOMB_EXECUTE,this.boundOnBombExecute),this.eventSystem.on(h.Events.BOOSTER_TELEPORT_EXECUTE,this.boundOnTeleportExecute),this.eventSystem.on(h.Events.TILES_DESTROYED,this.boundOnTilesDestroyed)},e.prototype.initializeContainer=function(t){this.config=t,this.clearAllTiles(),this.createTileGrid(),this.generateInitialTiles()},e.prototype.clearAllTiles=function(){if(this.node.removeAllChildren(),this.tiles)for(var t=0;t<this.tiles.length;t++)for(var e=0;e<this.tiles[t].length;e++)this.tiles[t][e]&&(this.tiles[t][e].destroyTile(),this.tiles[t][e]=null);this.tiles=[]},e.prototype.refreshEntireField=function(){this.clearAllTiles(),this.createTileGrid(),this.generateInitialTiles()},e.prototype.shuffleField=function(){this.clearAllTiles(),this.createTileGrid(),this.generateInitialTiles()},e.prototype.createTileGrid=function(){this.tiles=[];for(var t=0;t<this.config.fieldWidth;t++){this.tiles[t]=[];for(var e=0;e<this.config.fieldHeight;e++)this.tiles[t][e]=null}},e.prototype.generateInitialTiles=function(){for(var t=0;t<this.config.fieldWidth;t++)for(var e=0;e<this.config.fieldHeight;e++)this.createTileAt({x:t,y:e})},e.prototype.createTileAt=function(t){if(this.tilePrefab){var e=p.TileFactory.createRandomTile(t),o=cc.instantiate(this.tilePrefab),i=o.getComponent(u.Tile);if(i&&(i.initialize(e),this.tiles[t.x][t.y]=i),this.node){o.setParent(this.node);var n=this.getWorldPosition(t);o.setPosition(n)}}},e.prototype.getWorldPosition=function(t){return v.WorldPositionUtils.getWorldPosition(t)},e.prototype.onTileClicked=function(t){if(t){var e=t,o=this.getTileAt(e);o&&o.canBeClicked()&&(this.boosterSystem&&this.boosterSystem.isBoosterActive()||(this.isSuperTile(o)?this.activateSuperTile(o,e):this.findAndBurnGroup(e)))}},e.prototype.getTileAt=function(t){return this.isValidPosition(t)&&this.tiles[t.x]?this.tiles[t.x][t.y]:null},e.prototype.isValidPosition=function(t){return f.PositionUtils.isValidPosition(t)},e.prototype.isValidPositionXY=function(t,e){return f.PositionUtils.isValidPositionXY(t,e)},e.prototype.findAndBurnGroup=function(t){var e=this.getTileAt(t);if(e){var o=this.findConnectedTiles(t,e.type);o.length>=2&&(this.burnTiles(o),this.eventSystem.emit(h.Events.GROUP_BURNED_SUCCESSFULLY))}},e.prototype.findConnectedTiles=function(t,e){for(var o=[],i=[],n=0;n<this.config.fieldWidth;n++){o[n]=[];for(var s=0;s<this.config.fieldHeight;s++)o[n][s]=!1}return this.floodFill(t,e,o,i),i},e.prototype.floodFill=function(t,e,o,i){if(this.isValidPosition(t)&&!o[t.x][t.y]){var n=this.getTileAt(t);if(n&&n.type===e){o[t.x][t.y]=!0,i.push(t);for(var s=0,r=[{x:0,y:1},{x:0,y:-1},{x:1,y:0},{x:-1,y:0}];s<r.length;s++){var c=r[s],l={x:t.x+c.x,y:t.y+c.y};this.floodFill(l,e,o,i)}}}},e.prototype.burnTiles=function(t){this.eventSystem.emit(h.Events.TILES_BURNED,t)},e.prototype.onTilesDestroyed=function(t){if(t){var e=t;this.destroyTilesAfterAnimation(e)}},e.prototype.destroyTilesAfterAnimation=function(t){for(var e=this,o=0,i=t;o<i.length;o++){var n=i[o],s=this.getTileAt(n);s&&(s.setState(a.TileState.BURNING),s.destroyTile(),this.tiles[n.x][n.y]=null)}t.length>=4&&!this.wasSuperTileActivation&&this.createSuperTile(t[0],t.length),this.wasSuperTileActivation=!1,this.scheduleOnce(function(){e.processGravity()},.05)},e.prototype.processGravity=function(){this.applyGravity(),this.fillEmptySpaces()},e.prototype.applyGravity=function(){for(var t=0;t<this.config.fieldWidth;t++)this.processColumn(t)},e.prototype.processColumn=function(t){for(var e=[],o=this.config.fieldHeight-1;o>=0;o--){var i=this.tiles[t][o];i&&e.push(i)}for(o=0;o<this.config.fieldHeight;o++)this.tiles[t][o]=null;for(var n=0;n<e.length;n++){var s=this.config.fieldHeight-1-n;this.tiles[t][s]=e[n];var r={x:t,y:s};e[n].position=r,this.animateTileFall(e[n],r)}},e.prototype.fillEmptySpaces=function(){for(var t=this,e=[],o=0;o<this.config.fieldWidth;o++)for(var i=0;i<this.config.fieldHeight;i++)this.tiles[o][i]||e.push({x:o,y:i});this.scheduleOnce(function(){t.animateNewTilesCreation(e)},.1)},e.prototype.animateNewTilesCreation=function(t){for(var e=function(e){var i=t[e];o.createTileAt(i);var n=o.getTileAt(i);if(n){var s=o.getWorldPosition(i),r=s.y+200;n.node.y=r;var c=cc.tween(n.node).to(.2,{position:cc.v3(s.x,s.y,0)}).start(),l=function(){c&&c.stop()};n.node.on("destroy",l),n.node.on("remove",l)}},o=this,i=0;i<t.length;i++)e(i)},e.prototype.animateTileFall=function(t,e){var o=this.getWorldPosition(e),i=cc.tween(t.node).to(.15,{position:cc.v3(o.x,o.y,0)}).start(),n=function(){i&&i.stop()};t.node.on("destroy",n),t.node.on("remove",n)},e.prototype.createSuperTile=function(t,e){var o=this.getSuperTileType(e);if(o!==a.TileType.BLUE){var i={type:o,position:t,isSpecial:!0,specialType:o},n=cc.instantiate(this.tilePrefab),s=n.getComponent(u.Tile);s&&(s.initialize(i),this.tiles[t.x][t.y]=s),n.setParent(this.node);var r=this.getWorldPosition(t);n.setPosition(r)}},e.prototype.getSuperTileType=function(t){return t>=8?a.TileType.SUPER_BOMB_MAX:t>=6?a.TileType.SUPER_BOMB:t>=4?Math.random()<.5?a.TileType.SUPER_ROW:a.TileType.SUPER_COLUMN:a.TileType.BLUE},e.prototype.isSuperTile=function(t){return t.type===a.TileType.SUPER_ROW||t.type===a.TileType.SUPER_COLUMN||t.type===a.TileType.SUPER_BOMB||t.type===a.TileType.SUPER_BOMB_MAX},e.prototype.activateSuperTile=function(t,e){if(t.state!==a.TileState.BURNING){t.setState(a.TileState.BURNING),this.wasSuperTileActivation=!0;var o=[];switch(t.type){case a.TileType.SUPER_ROW:o=this.getTilesInRow(e.y);break;case a.TileType.SUPER_COLUMN:o=this.getTilesInColumn(e.x);break;case a.TileType.SUPER_BOMB:o=this.getTilesInRadius(e.x,e.y,1);break;case a.TileType.SUPER_BOMB_MAX:var i=this.getTilesInRow(e.y),n=this.getTilesInColumn(e.x);o=this.mergeTilePositions(i,n)}o.length>0&&(o.push(e),this.burnTiles(o),this.eventSystem.emit(h.Events.GROUP_BURNED_SUCCESSFULLY))}},e.prototype.getTilesInRow=function(t){for(var e=[],o=0;o<this.config.fieldWidth;o++)this.tiles[o][t]&&e.push({x:o,y:t});return e},e.prototype.getTilesInColumn=function(t){for(var e=[],o=0;o<this.config.fieldHeight;o++)this.tiles[t][o]&&e.push({x:t,y:o});return e},e.prototype.getTilesInRadius=function(t,e,o){return d.TileAreaUtils.getTilesInRadius({x:t,y:e},o)},e.prototype.mergeTilePositions=function(t,e){return d.TileAreaUtils.mergeTilePositions(t,e)},e.prototype.onBombExecute=function(t){t&&t.positions&&t.positions.length>0&&this.burnTiles(t.positions)},e.prototype.onTeleportExecute=function(t){t&&t.position1&&t.position2&&this.swapTiles(t.position1,t.position2)},e.prototype.swapTiles=function(t,e){var o=this.getTileAt(t),i=this.getTileAt(e);if(o&&i){var n=o.type,s=i.type;o.type=s,i.type=n,o.updateVisual&&o.updateVisual(),i.updateVisual&&i.updateVisual()}},e.prototype.onDestroy=function(){this.eventSystem.off(h.Events.TILE_CLICKED,this.boundOnTileClicked),this.eventSystem.off(h.Events.BOOSTER_BOMB_EXECUTE,this.boundOnBombExecute),this.eventSystem.off(h.Events.BOOSTER_TELEPORT_EXECUTE,this.boundOnTeleportExecute),this.eventSystem.off(h.Events.TILES_DESTROYED,this.boundOnTilesDestroyed),this.unscheduleAllCallbacks()},s([l(cc.Prefab)],e.prototype,"tilePrefab",void 0),s([l(y.BoosterSystem)],e.prototype,"boosterSystem",void 0),s([c],e)}(cc.Component);o.TileContainer=T,cc._RF.pop()},{"../Boosters/BoosterSystem":"BoosterSystem","../Core/EventSystem":"EventSystem","../Core/GameState":"GameState","../Tiles/Tile":"Tile","../Tiles/TileFactory":"TileFactory","../Utils/PositionUtils":"PositionUtils","../Utils/TileAreaUtils":"TileAreaUtils","../Utils/WorldPositionUtils":"WorldPositionUtils"}],TileFactory:[function(t,e,o){"use strict";cc._RF.push(e,"1b2b0LHc2NGLKUgPC/9Yoz4","TileFactory");var i=this&&this.__spreadArrays||function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<o;e++)for(var s=arguments[e],r=0,c=s.length;r<c;r++,n++)i[n]=s[r];return i};Object.defineProperty(o,"__esModule",{value:!0}),o.TileFactory=void 0;var n=t("../Core/GameState"),s=function(){function t(){}return t.createRandomTile=function(t){return{type:this.getRandomTileType(),position:t,isSpecial:!1}},t.createTileOfType=function(t,e){return{type:t,position:e,isSpecial:!1}},t.getRandomTileType=function(){var t=Math.floor(Math.random()*this.tileTypes.length);return this.tileTypes[t]},t.getAllTileTypes=function(){return i(this.tileTypes)},t.tileTypes=[n.TileType.BLUE,n.TileType.GREEN,n.TileType.RED,n.TileType.YELLOW,n.TileType.PURPLE],t}();o.TileFactory=s,cc._RF.pop()},{"../Core/GameState":"GameState"}],TileTypes:[function(t,e,o){"use strict";cc._RF.push(e,"f64491nJfFEno8OlsMf3Itc","TileTypes"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],Tile:[function(t,e,o){"use strict";cc._RF.push(e,"1c2e8kVszFMu4QvtThehiCJ","Tile");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=this&&this.__decorate||function(t,e,o,i){var n,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(s<3?n(r):s>3?n(e,o,r):n(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.Tile=void 0;var r=cc._decorator,c=r.ccclass,l=r.property,a=t("../Core/GameState"),p=t("../Core/EventSystem"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprite=null,e.button=null,e.tileSprites=[],e.state=a.TileState.NORMAL,e.isSpecial=!1,e.specialType="",e}return n(e,t),e.prototype.onLoad=function(){this.eventSystem=p.EventSystem.getInstance(),this.setupButton()},e.prototype.setupButton=function(){this.button&&this.button.node.on(cc.Node.EventType.TOUCH_END,this.onTileClicked,this)},e.prototype.initialize=function(t){this.type=t.type,this.position=t.position,this.isSpecial=t.isSpecial||!1,this.specialType=t.specialType||"",this.state=a.TileState.NORMAL,this.node.setContentSize(100,112),this.sprite&&this.sprite.node.setContentSize(100,112),this.updateVisual()},e.prototype.updateVisual=function(){if(this.sprite&&this.tileSprites.length>0){var t=this.getSpriteIndex();t>=0&&t<this.tileSprites.length&&(this.sprite.spriteFrame=this.tileSprites[t])}},e.prototype.getSpriteIndex=function(){var t;return((t={})[a.TileType.BLUE]=0,t[a.TileType.GREEN]=1,t[a.TileType.RED]=2,t[a.TileType.YELLOW]=3,t[a.TileType.PURPLE]=4,t[a.TileType.SUPER_BOMB]=5,t[a.TileType.SUPER_BOMB_MAX]=6,t[a.TileType.SUPER_COLUMN]=7,t[a.TileType.SUPER_ROW]=8,t)[this.type]||0},e.prototype.onTileClicked=function(){this.state===a.TileState.NORMAL&&this.eventSystem.emit(p.Events.TILE_CLICKED,this.position)},e.prototype.setState=function(t){this.state=t,this.updateVisual()},e.prototype.canBeClicked=function(){return this.state===a.TileState.NORMAL},e.prototype.destroyTile=function(){this.node.destroy()},s([l(cc.Sprite)],e.prototype,"sprite",void 0),s([l(cc.Button)],e.prototype,"button",void 0),s([l([cc.SpriteFrame])],e.prototype,"tileSprites",void 0),s([c],e)}(cc.Component);o.Tile=u,cc._RF.pop()},{"../Core/EventSystem":"EventSystem","../Core/GameState":"GameState"}],WorldPositionUtils:[function(t,e,o){"use strict";cc._RF.push(e,"3eb36alEZlKcLSHzqCIWEOF","WorldPositionUtils"),Object.defineProperty(o,"__esModule",{value:!0}),o.WorldPositionUtils=void 0;var i=function(){function t(){}return t.getWorldPosition=function(t){var e=-(this.FIELD_WIDTH-1)*this.SPACING/2,o=(this.FIELD_HEIGHT-1)*this.SPACING/2;return cc.v2(e+t.x*this.SPACING,o-t.y*this.SPACING)},t.getWorldPositionForField=function(t){var e=80*-(this.FIELD_WIDTH-1)/2,o=80*(this.FIELD_HEIGHT-1)/2;return cc.v2(e+80*t.x,o-80*t.y)},t.TILE_SIZE=100,t.SPACING=120,t.FIELD_WIDTH=8,t.FIELD_HEIGHT=8,t}();o.WorldPositionUtils=i,cc._RF.pop()},{}]},{},["AnimationManager","BoosterSystem","BoosterUI","BoosterTypes","EventSystem","GameManager","GameState","GameField","TileContainer","Tile","TileFactory","TileTypes","GameUIManager","PositionUtils","TileAreaUtils","WorldPositionUtils"]);
//# sourceMappingURL=index.js.map
